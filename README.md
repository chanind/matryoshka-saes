Matryoshka implementation is in `sae.py`.
Vanilla is a special case of Matryoshka where the number of prefixes is 1.

See `train_toy.ipynb` for the code to train a Matryoshka and Vanilla SAE on the toy model.

The toy model in this repo is very similar to the excellent concurrent work [Toy Model of Feature Absorption](https://www.lesswrong.com/posts/kcg58WhRxFA9hv9vN/toy-models-of-feature-absorption-in-saes).

![image](https://github.com/user-attachments/assets/ba5be9d7-b8b3-4583-b8a0-7a6ae248aa42)
<br><br><br><br>
<p align="center">
  <img src="https://github.com/noanabeshima/matryoshka-saes/blob/main/figures/ground_truth.png" width="800" alt="Ground-truth features">
  <br><br>
  <img src="https://github.com/noanabeshima/matryoshka-saes/blob/main/figures/vanilla.png" width="1200" alt="Ground-truth features">
  <br><br>
  <img src="https://github.com/noanabeshima/matryoshka-saes/blob/main/figures/matryoshka.png" width="1200" alt="Ground-truth features">
</p>



