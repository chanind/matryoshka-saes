Matryoshka implementation is in `sae.py`.
Vanilla is a special case of Matryoshka where the number of prefixes is 1.

The toy model in this repo is very similar to the concurrent work [Toy Model of Feature Absorption](https://www.lesswrong.com/posts/kcg58WhRxFA9hv9vN/toy-models-of-feature-absorption-in-saes).

See `train_toy.ipynb` for the code to train a Matryoshka and Vanilla SAE on the toy model.


<img src="https://github.com/noanabeshima/matryoshka-saes/blob/main/figures/ground_truth.png" width="800" alt="Ground-truth features">

<img src="https://github.com/noanabeshima/matryoshka-saes/blob/main/figures/vanilla.png" width="1200" alt="Ground-truth features">
<img src="https://github.com/noanabeshima/matryoshka-saes/blob/main/figures/matryoshka.png" width="1200" alt="Ground-truth features">


